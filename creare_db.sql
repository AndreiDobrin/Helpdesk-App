CREATE TABLE REGIONALI (
    ID_REGIONAL NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    NUME VARCHAR2(50),
    PRENUME VARCHAR2(50),
    EMAIL VARCHAR2(50),
    NR_TEL VARCHAR2(15)
);

CREATE TABLE MAGAZINE (
    ID_MAGAZIN NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    ORAS VARCHAR2(50),
    NUME_MAGAZIN VARCHAR2(50),
    ADRESA VARCHAR2(50),
    ID_REGIONAL NUMBER REFERENCES REGIONALI(ID_REGIONAL)
);

CREATE TABLE CASE_MARCAT (
    ID_CASA NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    NUMAR_CASA NUMBER,
    ADRESA_IP VARCHAR2(16),
    REZERVA NUMBER(1) DEFAULT 0 CHECK (REZERVA IN (0, 1)),
    ID_MAGAZIN NUMBER REFERENCES MAGAZINE(ID_MAGAZIN)
);

CREATE TABLE UPSURI (
    ID_UPS NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    ACTIV NUMBER(1) DEFAULT 0 CHECK (ACTIV IN (0, 1)),
    ID_MAGAZIN NUMBER REFERENCES MAGAZINE(ID_MAGAZIN)
);

CREATE TABLE ECHIPE (
    ID_ECHIPA NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    NUME VARCHAR2(50),
    NR_TEL VARCHAR2(15)
);

CREATE TABLE DEPARTAMENTE (
    ID_DEPARTAMENT NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    NUME VARCHAR2(50),
    BUGET NUMBER
);

CREATE TABLE DEPARTAMENTE_MAGAZIN (
    ID_MAGAZIN NUMBER,
    ID_DEPARTAMENT NUMBER,
    
    CONSTRAINT FK_DM_MAGAZIN FOREIGN KEY (ID_MAGAZIN)
        REFERENCES MAGAZINE(ID_MAGAZIN) ON DELETE CASCADE,

    CONSTRAINT FK_DM_DEPARTAMENT FOREIGN KEY (ID_DEPARTAMENT)
        REFERENCES DEPARTAMENTE(ID_DEPARTAMENT) ON DELETE CASCADE,

    CONSTRAINT PK_DEPARTAMENTE_MAGAZIN PRIMARY KEY (ID_MAGAZIN, ID_DEPARTAMENT)
);

CREATE TABLE ANGAJATI (
    ID_ANGAJAT NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    NUME VARCHAR2(50) NOT NULL,
    PRENUME VARCHAR2(50) NOT NULL,
    FUNCTIE VARCHAR2(50),
    ACTIV NUMBER(1) DEFAULT 0 CHECK (ACTIV IN (0, 1)),
    SALARIU NUMBER,

    ID_MAGAZIN NUMBER,
    ID_DEPARTAMENT NUMBER,

    CONSTRAINT FK_ANGAJAT_LOCATIE FOREIGN KEY (ID_MAGAZIN, ID_DEPARTAMENT)
        REFERENCES DEPARTAMENTE_MAGAZIN(ID_MAGAZIN, ID_DEPARTAMENT)
);

CREATE TABLE DOCUMENTE (
    ID_DOCUMENT NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    NUME VARCHAR2(50),
    LOCATIE VARCHAR2(50),
    DIMENSIUNE NUMBER,
    FORMAT_DOC VARCHAR2(10)
);

CREATE TABLE TICHETE (
    ID_TICHET NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    TITLU VARCHAR2(50),
    DESCRIERE VARCHAR2(500),
    PRIORITATE NUMBER(1) DEFAULT 3 CHECK (PRIORITATE IN (1, 2, 3)),
    CATEGORIE VARCHAR2(50),
    DATA_CREARE DATE DEFAULT SYSDATE,
    STATUS_TICHET VARCHAR2(15) DEFAULT 'Deschis' CHECK (STATUS_TICHET IN ('Deschis', 'In lucru', 'In service', 'Wait event', 'Rezolvat')),

    ID_ANGAJAT NUMBER REFERENCES ANGAJATI(ID_ANGAJAT),
    ID_ECHIPA NUMBER REFERENCES ECHIPE(ID_ECHIPA),
    ID_MAGAZIN NUMBER REFERENCES MAGAZINE(ID_MAGAZIN),
    ID_CASA NUMBER REFERENCES CASE_MARCAT(ID_CASA),
    ID_DOCUMENT NUMBER REFERENCES DOCUMENTE(ID_DOCUMENT),
    ID_UPS NUMBER REFERENCES UPSURI(ID_UPS)
);